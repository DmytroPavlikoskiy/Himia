<!doctype html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Basket</title>
<!--    <link rel="stylesheet" href="../static/css/main.css">-->
    <link rel="stylesheet" href="{% static 'css/header.css' %}">
<!--    <link rel="stylesheet" href="{% static 'css/checkout.css' %}">-->
    <link rel="stylesheet" href="{% static 'css/basket.css' %}">
    <link rel="stylesheet" href="{% static 'css/fonts.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'js/slick/slick.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'js/slick/slick-theme.css' %}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">

    <script>
        const cartItem = '{{order.get_cart_item}}'
        const totalPrice = '{{order.get_cart_total}}'
        let csrftoken = '{% csrf_token %}'
    </script>
</head>
<body>
<div class="header">
    <div class="lower_head">
        <a href="{% url 'home' %}" class="logo_cont">
            <div class="logo">
                <img class="img" src="{% static 'images/Eva_logo.svg-removebg-preview.png' %}" alt="">
            </div>
        </a>
        <div class="navigations">
            <a href="" class="nav_link">Головна</a>
            <a href="" class="nav_link">Про Нас</a>
            <a href="" class="nav_link">Доставка</a>
            <a href="" class="nav_link">Акції</a>
        </div>
        {% if user.is_authenticated %}
        <div class="menu_cont">
            <a href="#" class="menu" id="profile"><img class="img_prof" src="{% static 'images/free-icon-profile-3736502.png' %}"></a>

            <div class="sub_menu_wrap" id="profile_modal_js">
                <div class="sub_menu">
                    <div class="user_info">
                        <img class="img" src="{% if user %} {{ user.images.url }} {% else %} {% static  'images/free-icon-profile-3736502.png' %} {% endif %}">
                        <h3 class="user_info_name">{{ user.username }}</h3>
                    </div>
                    <hr>
                    <a href="#" class="sub_menu_link">
                        <img class="sub_menu_img" src="{% static 'images/free-icon-bonus-8525690.png' %}">
                        <p class="p_text">Бонуси: <span class="bonus_span">0</span></p>
                    </a>
                    <hr>
                    <a href="#" class="sub_menu_link">
                        <img class="sub_menu_img" src="{% static 'images/free-icon-user-9630184.png' %}">
                        <p class="p_text">Мій Профіль</p>
                        <span> > </span>
                    </a>
                    <hr>
                    <a href="{% url 'logout' %}" class="sub_menu_link">
                        <img class="sub_menu_img" src="{% static 'images/free-icon-sign-out-7168079.png' %}">
                        <p class="p_text">Вийти</p>
                        <span> > </span>
                    </a>
                </div>
            </div>

            <a class="menu search" id="search"><span id="icon_search" class="material-symbols-outlined">manage_search</span></a>
            <a href="{% url 'basket_detail' %}" class="menu basket">
                <img class="img_basket" src="{% static 'images/shopping.svg' %}">
                <span class="number_goods">{{ order.get_cart_item|default:"0" }}</span>
            </a>
        </div>
        {% else %}
        <div class="menu_cont">
            <a class="menu search" id="search"><span id="icon_search" class="material-symbols-outlined">manage_search</span></a>
            <a href="{% url 'basket_detail' %}" class="menu basket">
                <img class="img_basket" src="{% static 'images/shopping.svg' %}">
                <span class="number_goods">{{ order.get_cart_item|default:"0" }}</span>
            </a>
            <a class="menu exit" id="res_log_modal_btn"><span class="material-symbols-outlined">login</span>Вхід</a>
        </div>
        {% endif %}
    </div>
    <div class="cont_search" id="div_search">
        <a class="category_btn" id="cat_btn" onclick="OpenCat()">
            Категорії Товарів<span class="material-symbols-outlined arrow_icon" id="arrow_cat">expand_more</span>
        </a>
        <div class="cat_menu_wrap">
            <div class="cat_menu">
                <div class="cat_cont">
                    {% for cat in category %}
                    <div class="cat_content" data-slug="{{ cat.id }}">
                        <div class="circle"><img class="cat_img" src="{{ cat.image.url }}"></div>
                        <h2 class="cat_text" data-cat_name="{{ cat.name }}">{{ cat.name }} <span class="cat_arrow">></span></h2>
                    </div>
                    <hr>
                    {% endfor %}
                </div>
                <div class="sub_cut_control">
                    <div class="name_cut"></div>
                    {% for sub_cut in sub_category %}
                    <div class="sub_cut_content" data-id="{{ sub_cut.category.id }}">
                        <a class="sub_cut_text" href="{% url 'sub_cut_products' sub_cut.slug %}" >{{ sub_cut.name }} <span class="line_sub"></span></a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <form class="search_form" action="{% url 'home' %}" method="get">
            <input class="s_input" id="input_search" type="search" name="q" placeholder="Пошук товарів">
            <button id="btn" class="btn" type="submit">Пошук</button>
        </form>
    </div>
</div>


<div class="err-suc_message">
    <p class="error-success_text" id="error-success_text"></p>

    <div class="close_icon">
        <img src="../static/images/cancel-svgrepo-com.svg" class="cans_img" id="message_close_btn">
    </div>
</div>


<!--==================================================-->
<!--MODAL REG-LOG-->

<div class="block_login_reg_modal">
    <div class="log_reg_cart">
        <div class="cart_inner">
            <div class="cart_face face-cart--front">
                <div class="open_close__front">
                    <span class="material-symbols-outlined close">
                        cancel
                    </span>
                </div>
                <div class="animation-area">
                    <ul class="box-area">
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <form class="login_cart_cont" id="login_from">
                    <h2>Вхід</h2>
                    <div class="login_form">
                        <input type="text" placeholder="Пошта" name="email" class="inp_login js_email_inp">
                        <div class="password-input-wrapper">
                            <input type="password" placeholder="Пароль" name="password" class="inp_login js-password-input">
                            <span class="material-symbols-outlined btn_pass">visibility_off</span>
                        </div>
                    </div>
                    <div class="cont_btn">
                        <button type="submit" id="login_btn" class="login_btn">Увійти</button>
                        <p>Якшо, у вас ще немає Аккаунта <a class="redirect_register_btn">Реєстрація</a></p>
                    </div>
                </form>
            </div>

            <div class="cart_face face-cart--back">
                <div class="open_close__back">
                    <span class="material-symbols-outlined close">
                        cancel
                    </span>
                </div>
                <div class="animation-area2">
                    <ul class="box-area2">
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="register_cart_cont">
                    <h2>Реєстрація</h2>
                    <form class="register_form js-form">
                        <input type="text" placeholder="Ім'я" name="first_name" class="inp_reg" >
                        <input type="text" placeholder="Прізвище" name="last_name" class="inp_reg" >
                        <input type="email" placeholder="Електронна Пошта" name="email" class="inp_reg js-input-email" >
                        <input type="tel" placeholder="+380(99) 999-99-99" name="phone_number" class="inp_reg js-input-phone art-stranger" >
                        <input type="password" placeholder="Пароль" name="password" class="inp_reg" >
                        <div class="cont_checkbox">
                            <input type="checkbox" name="checkbox" value="" class="inp_reg inp_checkbox js-input-checkbox">
                            <h3>Реєструючись, я приймаю умови публічної <a href="">оферти</a> та надаю згоду на <a href="">обробку персональних даних</a>.</h3>
                        </div>
                        <div class="cont_btn">
                            <button type="submit" id="redirect_btn" class="reg_btn">Зареєструватись</button>
                            <p>Якшо, у вас вже є Аккаунта <a class="redirect_login_btn">Вхід</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!--=======================================================-->

<div class="basket-control">
    <div class="basket-cart">
        <div class="basket_header">
            <div class="header_count_items">
                <h2>Корзина</h2>
                <span class="total_cart_items">Товарів в корзині: <span class="total_items">{{ order.get_cart_item|default:"0" }}</span></span>
            </div>
            <div data-session_user_id="{% if order.session_id %}{{ order.session_id }}{% else %}{{ order.user.id }}{% endif %}"
                 data-order_id="{% if order %}{{ order.id }}{% else %}{{ None }}{% endif %}" class="close_div" onclick="RemoveAllBasket()"><span class="material-symbols-outlined c_b_icon">close</span></div>
        </div>
        <div class="basket_product_cart">
            {% if items %}
            {% for item in items %}
            <div class="basket_product">
                <img class="basket_product_img" src="{{ item.product.image.url }}">
                <div class="control_midle_div">
                    <div class="product_info">
                        <h2>{{ item.product.name }}</h2>
                    </div>
                    <div class="counter">
                        <button class="counter_btn minus" data-product="{{ item.product.id }}"
                                onclick="BasketRemoveProduct(this)"><span
                                class="material-symbols-outlined">remove</span></button>

                        <input min="1" max="{{ item.product.available }}" oninput="InputPlusMinusProduct(this)" step="1"
                               type="text" inputmode="numeric" value="{{ item.quantity }}"
                               pattern="[0-9]" class="counter_input" id="{{ item.product.id }}">

                        <button data-product="{{ item.product.id }}" class="counter_btn plus"
                                onclick="BasketAddProduct(this)"><span class="material-symbols-outlined">add</span>
                        </button>
                    </div>
                </div>
                {% if item.product.action %}
                <div class="product_price">
                    <img data-product="{{ item.product.id }}"
                         class="close_basket_product" id="product{{ item.product.id }}" onclick="RemoveProduct(this)" src="{% static 'images/cancel-svgrepo-com.svg' %}">
                    <div class="p_info">
                            <span class="product_p_span basket_old_price old_price{{ item.product.id }}">{{ item.get_total.old_price }} <span
                                    class="basket_old_price">₴</span></span>
                        <span class="product_p_span action">{{ item.product.discount }} <span
                                class="interest">%</span></span>
                    </div>
                    <span class="product_p_span price all_price{{ item.product.id }}">{{ item.get_total.total|floatformat:2 }} <span>₴</span></span>
                </div>
                {% else %}
                <div data-action="remove_product" data-product="{{ item.product.id }}"
                     class="product_price update-cart">
                    <img data-product="{{ item.product.id }}"
                         class="close_basket_product" id="product{{ item.product.id }}" onclick="RemoveProduct(this)" src="{% static 'images/cancel-svgrepo-com.svg' %}">
                    <span class="product_p_span price all_price{{ item.product.id }}">{{ item.get_total.total|floatformat:2 }} <span>₴</span></span>
                </div>
                {% endif %}
            </div>
            {% endfor %}
            {% else %}
            <div class="basket_product">
                <div class="basket_empty">
                    <img src="{% static 'images/basket-icon-16.jpg' %}">
                    <h3>Корзина Пуста</h3>
                    <p>Скористайтеся Пошуком або Каталогом, щоб знайти те, що потрібно.</p>
                </div>
            </div>
            {% endif %}
        </div>
        <div class="total">
            <div class="total_price_control">
                <p>Всього </p>
                <span class="total_price">{{ order.get_cart_total|default:"0"|floatformat:2 }} <span
                        class="currency">₴</span></span>
            </div>
            <div class="placing_an_order">
                <a class="back_to_shop_btn" id="back_to_shop_btn" href="/">В Магазин</a>
                <a class="placing_order" id="ord_back_btn" href=""> </a>
            </div>
        </div>
    </div>
</div>

<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>-->
<!--<script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'js/GetCSRFToken.js' %}"></script>
<script src="{% static 'js/messages.js' %}"></script>
<script src="{% static 'js/remove_localStorage.js' %}"></script>
<script src="{% static 'js/search.js' %}"></script>
<script src="{% static 'js/RegLog.js' %}"></script>
<script src="{% static 'js/profile.js' %}"></script>
<script src="{% static 'js/basket.js' %}"></script>
<!--<script src="{% static 'js/checkout.js' %}"></script>-->
<script src="{% static 'js/order_or_back_shop_bnt.js' %}"></script>
<script type="text/javascript" src="{% static 'js/mask_number.js' %}"></script>
<script type="text/javascript" src="{% static 'js/formatPhoneInput.js' %}"></script>
<script src="{% static 'js/slick-slider.js' %}"></script>
<script src="{% static 'js/slick/slick.min.js' %}"></script>
<!--<script src="../static/js/paginator.js"></script>-->
<!--<script src="../static/js/sub_cat_paginations.js"></script>-->
</body>
</html>